查询mysql版本
select version();

连接远程库
mysql -h 182.167.12.3 -u user1 -p -P 3308

连接本地数据库
mysql -u root -p

创建数据库
CREATE DATABASE IF NOT EXISTS RUNOOB DEFAULT CHARSET utf8 COLLATE utf8_general_ci;

查看所有数据库
show databases;

查看所有表
use 数据库
show tables;

显示创建表语句
show create table table_name;

查看某张表的所有列
show full columns from 表名;

显示表信息
desc table_name;

创建表
CREATE TABLE
    t_carrier_basic
    (
        id bigint NOT NULL AUTO_INCREMENT,
        userId VARCHAR(255) COLLATE utf8_bin NOT NULL COMMENT '用户id，创建任务时的userid',
        name VARCHAR(24) COMMENT '姓名',
        mobile VARCHAR(24) NOT NULL COMMENT '手机号码',
        idcard VARCHAR(64) COMMENT '证件号',
        carrier VARCHAR(16) NOT NULL COMMENT '1-移动; 2-联通; 3-电信',
        province VARCHAR(24) NOT NULL COMMENT '省份',
        city VARCHAR(8) COMMENT '城市',
        openTime VARCHAR(16) COMMENT '开卡时间',
        level VARCHAR(8) COMMENT '星级',
        packageName VARCHAR(128) COMMENT '手机套餐名称',
        availableBalance INT COMMENT '可用余额(单位分)',
        state INT,
        reliability INT(2) DEFAULT '0' COMMENT '实名状态',
        createTime DATETIME DEFAULT '1970-01-02 00:00:00' NOT NULL COMMENT '创建时间',
        lastModifyTime DATETIME DEFAULT '1970-01-02 00:00:00' NOT NULL COMMENT '最后修改时间',
        PRIMARY KEY (id),
        INDEX MOBILE (mobile)
    )

    ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='手机基本信息';


表重命名
rename table table_name1 to table_name2;

清除表内数据
truncate table table_name;

删除数据
delete from table_name;

删除表
drop table table_name;

插入数据
insert into table_name(column1,column2,column3,column4) values(values1,values2,values3,values4); 

查询
select * from table_name where condition limit n offset m;
Limit指定返回的记录数
offset指定select查询开始的偏移量 默认为0
等价于
select * from table_name limit m,n;
m为0等价于
select * from t_carrier_basic limit n;

update
update table_name set filed1='' where condition;

delete
delete from table_name where condition;

like 和 通配符
% 
替代一个或多个字符 
_ 
仅替代一个字符 
[charlist] 
字符列中的任何单一字符 
[^charlist]
或者
[!charlist]
不在字符列中的任何单一字符 


union
将select语句的结果集合组合到一个结果集合中。多个select会删除重复的数据。
SELECT expression1, expression2, ... expression_n
FROM tables
[WHERE conditions]
UNION [ALL | DISTINCT]
SELECT expression1, expression2, ... expression_n
FROM tables
[WHERE conditions];

all不删除重复的数据
distinct删除重复的数据
默认删除重复数据

order by 排序
order by filed1,filed2 desc|asc;

group by根据一个或多个列 对结果集进行分组
SELECT column_name, function(column_name)
FROM table_name
WHERE column_name operator value
GROUP BY column_name;

having用来过滤分组 where用来过滤行 where在数据分组前过滤 having在数据分组后过滤
一般在使用group by时,order by也要给出

join
mysql不支持全连接 支持inner join(等值连接), left join, right join
可以通过union来实现全连接 
select * from A left join B on A.id = B.id (where 条件）
union
select * from A right join B on A.id = B.id （where条件);
![WX20180423-171452@2x](media/15174750554215/WX20180423-171452@2x.png)

内连接
SELECT a.id, a.author, b.count FROM tbl a INNER JOIN tcount_tbl b ON a.author = b.author;等价于
SELECT a.id, a.author, b.count FROM tbl a, tcount_tbl b WHERE a.author = b.author;

left outer join和left join等效
MySQL LEFT JOIN 会读取左边数据表的全部数据，即便右边表无对应数据。
MySQL RIGHT JOIN 会读取右边数据表的全部数据，即便左边边表无对应数据。

事务
1、用 BEGIN, ROLLBACK, COMMIT来实现
    BEGIN 开始一个事务
    ROLLBACK 事务回滚
    COMMIT 事务确认
2、直接用 SET 来改变 MySQL 的自动提交模式:
SET AUTOCOMMIT=0 禁止自动提交
SET AUTOCOMMIT=1 开启自动提交

alter
修改表名
alter table t_book rename to B;
添加列
alter table table_name add column column_name varchar(30);
删除列
alter table table_name drop column column_name;
修改列名MySQL
alter table table_name change filed1  filed2 int;
修改字段类型
ALTER TABLE testalter_tbl MODIFY c CHAR(10);
修改字段默认值
ALTER TABLE testalter_tbl ALTER i SET DEFAULT 1000;
修改存储引擎
alter table tableName engine=myisam;
修改外键
alter table tableName drop foreign key keyName;

索引
show index from table_name; 显示索引

创建索引
CREATE INDEX indexName ON mytable(username(length)); 普通索引
CREATE UNIQUE INDEX indexName ON mytable(username(length)) 唯一索引

INDEX [indexName] (username(length))创建表时创建

增加索引
ALTER table tableName ADD INDEX indexName(columnName)
ALTER table mytable ADD UNIQUE [indexName] (username(length))
ALTER TABLE tbl_name ADD FULLTEXT index_name (column_list) 全文索引
ALTER TABLE tbl_name ADD PRIMARY KEY (column_list)添加主键

使用全文索引需要注意的是：(基本单位是词)
分词，全文索引以词为基础的，MySQL默认的分词是所有非字母和数字的特殊符号都是分词符
![BC0ED9D3-C8F0-45DE-A6EA-F6FA2FD1A05](media/15174750554215/BC0ED9D3-C8F0-45DE-A6EA-F6FA2FD1A05C.png)
![02953770-AE00-45F3-BA07-24D114E8503E](media/15174750554215/02953770-AE00-45F3-BA07-24D114E8503E.png)
删除索引
ALTER TABLE testalter_tbl DROP INDEX c;
删除主键
ALTER TABLE testalter_tbl DROP PRIMARY KEY;

临时表
只对当前连接可见，连接关闭mysql会自动删除表并释放空间
CREATE TEMPORARY TABLE SalesSummary (
    product_name VARCHAR(50) NOT NULL,
    total_sales DECIMAL(12,2) NOT NULL DEFAULT 0.00,
    avg_unit_price DECIMAL(7,2) NOT NULL DEFAULT 0.00, 
    total_units_sold INT UNSIGNED NOT NULL DEFAULT 0)


复制表 3步
1 show create table table_name /G;
2 复制表定义 修改表名 create table clone1;
3 insert into table_name (field1,field2) select filed1,field2 from table_name;

元数据
命令
描述
SELECT VERSION( ) 
服务器版本信息 
SELECT DATABASE( ) 
当前数据库名 (或者返回空) 
SELECT USER( ) 
当前用户名 
SHOW STATUS 
服务器状态 
SHOW VARIABLES 
服务器配置变量 


mysql序列  如果要想多张表
最简单的是使用AUTO_INCREMENT



mysql导出数据库
sh-3.2#  mysqldump -u root -p mobill > ~/dump.txt;
远程
mysqldump -h other-host.com -P port -u root -p database_name > dump.txt

mysql导入
mysqlimport -u root -p --local database_name dump.txt


字符串拼接
SELECT Concat(vend_name, '(', vend_country ,')') FROM vendors ORDER BY vend_name;

常用函数

获取当前时间
select now();

去除首尾字符
trim();

大写转换
upper(field);

日期处理函数
date(field) = 'yyyy-MM-dd';格式
![2F3B1F06-004B-4A08-90AB-10D95387B13A](media/15174750554215/2F3B1F06-004B-4A08-90AB-10D95387B13A.png)
![4A18CF9E-5587-48EF-B07E-63AFCEFB73DD](media/15174750554215/4A18CF9E-5587-48EF-B07E-63AFCEFB73DD.png)
年
year(field) = 'yyyy'
![62D9FE2C-CBAC-4BF7-B177-6FF425F310A](media/15174750554215/62D9FE2C-CBAC-4BF7-B177-6FF425F310AC.png)
-- more date functions
-- AddDate(expr, days)    | add time values (intervals) to a date value
-- AddTime(expr1, expr2)  | add time
-- Now()                  | return datetime
-- CurDate()              | return current date
-- CurTime()              | return current time
-- Date(expr)             | return date part of expr
-- Time(expr)             | return time part of expr
-- Year(expr)             | return year part of expr
-- Month(expr)            | return month part of expr
-- Day(expr)              | return day part of expr
-- Hour(expr)             | return hour part of expr
-- Minute(expr)           | return minute part of expr
-- Second(expr)           | return second part of expr
-- DayOfWeek(expr)        | return day of expr
-- DateDiff(expr1, expr2) | return expr1 - expr2

-- numerical functions
-- Ceil()     | return the smallest integer value not less than the argument
-- Floor()    | return the largest integer value not greater than the argument
-- Ceiling()  | return the smallest integer value not less than the argument
-- Truncate() | truncate to specified number of decimal places
-- Radians()  | return argument converted to radians
-- Conv()     | convert numbers between different number bases
-- Round()    | round the argument

-- Asin()     | return the arc sine
-- Acos()     | return the arc cosine
-- Atan()     | return the arc tangent
-- Sin()      | return the sine of the argument
-- Cos()      | return the cosine
-- Tan()      | return the tangent of the argument
-- Cot()      | return the cotangent
-- Pi()       | return the value of pi
-- Ln()       | return the natural logarithm of the argument
-- Log()      | return the natural logarithm of the first argument
-- Log10()    | return the base-10 logarithm of the argument
-- Log2()     | return the base-2 logarithm of the argument
-- Exp()      | raise to the power of
-- Pow()      | return the argument raised to the specified power

-- Abs()      | return the absolute value
-- Sqrt()     | return the square root of the argument
-- Mod()      | return the remainder
-- Sign()     | return the sign of the argument
-- Rand()     | return a random floating-point value

存储过程



SHOW CHARACTER SET;显示编码
SHOW COLLATION;显示核对    

-- create account
CREATE USER ben IDENTIFIED BY 'password';
-- rename account
RENAME USER ben TO bforta;
-- delete account
DROP USER ben;
-- change password
SET PASSWORD FOR bforta = Password('new password');

-- show privileges
SHOW GRANTS FOR hujh;

-- grant all privileges
GRANT ALL PRIVILEGES ON database_name.* TO 'username'@'localhost' IDENTIFIED BY 'password';

check和analyze作用一样

mysql> analyze table t_carrier_basic;
+------------------------+---------+----------+----------+
| Table                  | Op      | Msg_type | Msg_text |
+------------------------+---------+----------+----------+
| mobill.t_carrier_basic | analyze | status   | OK       |
+------------------------+---------+----------+----------+
1 row in set (0.01 sec)

mysql> check table  t_carrier_basic;
+------------------------+-------+----------+----------+
| Table                  | Op    | Msg_type | Msg_text |
+------------------------+-------+----------+----------+
| mobill.t_carrier_basic | check | status   | OK       |
+------------------------+-------+----------+----------+
1 row in set (0.00 sec)



数据类型
三类：
数值 字符串 日期／时间
类型
大小
范围（有符号）
范围（无符号）
用途
TINYINT 
1 字节 
(-128，127) 
(0，255) 
小整数值 
SMALLINT 
2 字节 
(-32 768，32 767) 
(0，65 535) 
大整数值 
MEDIUMINT 
3 字节 
(-8 388 608，8 388 607) 
(0，16 777 215) 
大整数值 
INT或INTEGER 
4 字节 
(-2 147 483 648，2 147 483 647) 
(0，4 294 967 295) 
大整数值 
BIGINT 
8 字节 
(-9 233 372 036 854 775 808，9 223 372 036 854 775 807) 
(0，18 446 744 073 709 551 615) 
极大整数值 
FLOAT 
4 字节 
(-3.402 823 466 E+38，-1.175 494 351 E-38)，0，(1.175 494 351 E-38，3.402 823 466 351 E+38) 
0，(1.175 494 351 E-38，3.402 823 466 E+38) 
单精度
浮点数值 
DOUBLE 
8 字节 
(-1.797 693 134 862 315 7 E+308，-2.225 073 858 507 201 4 E-308)，0，(2.225 073 858 507 201 4 E-308，1.797 693 134 862 315 7 E+308) 
0，(2.225 073 858 507 201 4 E-308，1.797 693 134 862 315 7 E+308) 
双精度
浮点数值 
DECIMAL 
对DECIMAL(M,D) ，如果M>D，为M+2否则为D+2 
依赖于M和D的值 
依赖于M和D的值 



日期／时间
DATE 
3 
1000-01-01/9999-12-31 
YYYY-MM-DD 
日期值 
TIME 
3 
'-838:59:59'/'838:59:59' 
HH:MM:SS 
时间值或持续时间 
YEAR 
1 
1901/2155 
YYYY 
年份值 
DATETIME 
8 
1000-01-01 00:00:00/9999-12-31 23:59:59 
YYYY-MM-DD HH:MM:SS 
混合日期和时间值 
TIMESTAMP 
4 
1970-01-01 00:00:00/2038
结束时间是第 2147483647 秒，北京时间 2038-1-19 11:14:07，格林尼治时间 2038年1月19日 凌晨 03:14:07
YYYYMMDD HHMMSS 
混合日期和时间值，时间戳 
字符串
类型
大小
用途
CHAR 
0-255字节 
定长字符串 
VARCHAR 
0-65535 字节 
变长字符串 
TINYBLOB 
0-255字节 
不超过 255 个字符的二进制字符串 
TINYTEXT 
0-255字节 
短文本字符串 
BLOB 
0-65 535字节 
二进制形式的长文本数据 
TEXT 
0-65 535字节 
长文本数据 
MEDIUMBLOB 
0-16 777 215字节 
二进制形式的中等长度文本数据 
MEDIUMTEXT 
0-16 777 215字节 
中等长度文本数据 
LONGBLOB 
0-4 294 967 295字节 
二进制形式的极大文本数据 
LONGTEXT 
0-4 294 967 295字节 
极大文本数据 



